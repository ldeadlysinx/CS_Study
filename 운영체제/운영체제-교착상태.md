# 교착상태

**정의)
일어나지 않을 사건을 기다리며 진행이 멈춰 버리는 현상**


**식사하는 철학자 문제**

교착상태가 왜 발생하는지 설명해주는 문제
![](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/An_illustration_of_the_dining_philosophers_problem.png/220px-An_illustration_of_the_dining_philosophers_problem.png)

 1. 계속 생각을 하다가 왼쪽 포크가 사용 가능하면 집어든다.
 2. 계속 생각을 하다가 오른쪽 포크가 사용 가능하면 집어든다.
 3. 왼쪽과 오른쪽 포크를 모두 집어들면 정해진 시간동안 식사를 한다.
 4. 식사 시간이 끝나면 오른쪽 포크를 내려놓는다.
 5. 오른쪽 포크를 내려놓은뒤 왼쪽 포크를 내려놓는다.
 6. 다시 1번부터 반복한다.

**특징)**

 - 일부 철학자가 밥을 먹을경우는 문제가 없다.
 - 모든 철학자가 밥을 먹으려고 한경우 실행이 안된다(각자 왼쪽 포크를 집어든 경우 오른쪽  포크가 없으므로 오른쪽 포크가 나올때까지 기다린다.)
 
**예시)**
    ![운영체제 정리 🦖 ch07. 교착상태](https://blog.kakaocdn.net/dn/c2sPvH/btqNG00MVet/hLCkiQnvC6RhLIeN4FTg9K/img.png)

**문제파악하기)**
 1. 교착 상태가 발생했을 때의 상황을 정확히 표현해보기
     
     
    - 자원 할당 그래프가 원의 형태를 띄고 있을때 

	![운영체제 정리 🦖 ch07. 교착상태](https://blog.kakaocdn.net/dn/byKAK4/btqNHqkBYSI/skn2OGbgh776EbApwHVNKK/img.png)

     
 2. 교착 상태가 일어나는 근본적인 이유 이해하기
	 
	  발생할 조건
      - 상호 배제 : 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할수 없는 상태
      - 점유와 대기: 자원을 할당 받은 상태에서 다른 자원을 할당 받기를 원하는 상태
      - 비선점 : 어떤 프로세스도 다른 프로세스의 자원을 강제를 빼앗지 못하는 상태
      - 원형 대기 : 프로세스들이 원의 형태로 자원을 대기하는 상태


**해결방법**
	

 1. 교착 상태 예방
 
     애초에 교착상태를 발생하지 않도록 하는것
 
 - 상호 배제를 없앤다?
    모든 자원을 공유 가능하게 만든다.
    ->이론적으로 가능하지만 현실적인 방법은x
  
 - 점유와 대기를 없애면?
    특정 프로세스에 자원을 모두 할당하거나, 아예 할당하지 않는 방식으로 배분
     -> 자원의 활용률이 낮아진다(할당받지 못한 프로세스들은 오랫동안 대기)
    
    
 - 비선점 조건을 없애면?
	선점이 가능한 자원에 한해 효과적
	->모든 자원이 선점 가능한것은 x
 - 원형 대기 조건을 없애면?
	자원에 번호를 붙이고 오름차순으로 할당하면 원형대기 발생 x 
     (원의 형태에서 식사하는 철학자들이 일렬의 형태를 띄게 됨)
    -> 자원에 번호를 붙이는 것은 어려운 작업 어떤 자원에 어떤 번호를 붙이느냐에 따라 활용률이 달라진다
 2. 교착 상태 회피
     
  - 교착 상태를 무분별한 자원 할당으로 인해 발생했다고 간주
  - 교착 상태가 발생하지 않을 만큼 조심 조심 할당하기
  - 배분할 수 있는 자원의 양을 고려하면 교착 상태가 발생하지 않을 만큼만 배분 
  용어)
     - 안전순서열: 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는  순서
     -  안전상태: 교착 상태 없이 모든 프로세스가 자원을 할당 받고 종료될 수 있   는 상태(안전 순서열이 있는 상태)
     - 불안전 상태: 교착 상태가 발생할 수도 있는 상태 (안전 순서열이 없는 상태) 


3. 교착 상태 검출 후 회복
   
 - 선점을 통한 회복
    - 교착 상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식

  - 프로세스 강제 종료를 통한 회복
     - 교착 상태에 놓인 프로세스 모두 강제 종료(-> 작업 내역 잃을 위험)
     - 교착 상태가  해결될 때까지 한 프로세스씩 강제 종료(-> 오버헤드)

     cf) 타조 알고리즘(교착 상태를 아예 무시하는 방법)
